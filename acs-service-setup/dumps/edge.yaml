# REQUIRE: auth sparkplug
---
service: !u UUIDs.Service.ConfigDB
version: 2
objects:
  !u ConfigDB.Class.R2Class:
    !u Edge.Group.EdgeGroup:
      name: "Edge-managed group"
      subclassOf:
        - !u Auth.Class.EdgeRole

  # Not currently used. This would be difficult to implement with the
  # current implementation of composite perms as classes; we don't
  # support multi-rank classes yet.
  !u Auth.Class.PermissionGroup:
    !u Edge.Group.EdgePermission:
      name: "Edge-managed permissions"
      subclassOf:
        - !u Auth.Class.Permission

  !u Auth.Class.ServiceRole:
    !u ACS.Group.CentralMonitor:
      name: "Central monitor"
      subclassOf:
        - !u Auth.Class.CentralService
        - !u ACS.Group.SparkplugNode
        - !u ACS.Group.SparkplugReader

  !u UUIDs.Class.App:
    !u Edge.App.ClusterStatus:      { name: "Edge cluster status" }
    !u Edge.App.Deployment:         { name: "Edge deployment" }
---
service: !u UUIDs.Service.Authentication
version: 2
grants:
  !u ACS.Group.CentralMonitor:
    !u ACS.Role.EdgeNodeConsumer:
      !u ACS.Device.ConfigDB: false
    !u UUIDs.Permission.ConfigDB.ReadConfig:
      !u Edge.App.ClusterStatus: false
      !u UUIDs.App.SparkplugAddress: false
