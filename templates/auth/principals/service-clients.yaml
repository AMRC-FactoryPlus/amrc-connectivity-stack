{{- if .Values.identity.enabled }}
## Service client principals.
  ##
  ## These are the principals that services use when they are acting as a client of another
  ## service. These are the principals that should be granted rights.
  ##
  ## Random type principals get a random key and a Kerberos keytab. They are the most
  ## secure option but can only be used for services that can act as a Kerberos client.
  ##
  ## Password type principals get a random password generated by the system. This is next
  ## most secure.
  ##
  ## PresetPassword type principals use a password set by the administrator in the
  ## krb5-presets secret. This option should only be used for services that can't pull
  ## their password from a k8s secret, like Canary.
  #
apiVersion: factoryplus.app.amrc.co.uk/v1
kind: KerberosKey
metadata:
  name: sv1auth
  namespace: {{ .Release.Namespace }}
spec:
  type: Random
  principal: sv1auth@{{ .Values.identity.realm | required "values.identity.realm is required!" }}
---
apiVersion: factoryplus.app.amrc.co.uk/v1
kind: KerberosKey
metadata:
  name: sv1cmdesc
  namespace: {{ .Release.Namespace }}
spec:
  type: Random
  principal: sv1cmdesc@{{ .Values.identity.realm | required "values.identity.realm is required!" }}
---
apiVersion: factoryplus.app.amrc.co.uk/v1
kind: KerberosKey
metadata:
  name: sv1configdb
  namespace: {{ .Release.Namespace }}
spec:
  type: Random
  principal: sv1configdb@{{ .Values.identity.realm | required "values.identity.realm is required!" }}
---
apiVersion: factoryplus.app.amrc.co.uk/v1
kind: KerberosKey
metadata:
  name: sv1directory
  namespace: {{ .Release.Namespace }}
spec:
  type: Random
  principal: sv1directory@{{ .Values.identity.realm | required "values.identity.realm is required!" }}
---
apiVersion: factoryplus.app.amrc.co.uk/v1
kind: KerberosKey
metadata:
  name: sv1mqtt
  namespace: {{ .Release.Namespace }}
spec:
  type: Password
  principal: sv1mqtt@{{ .Values.identity.realm | required "values.identity.realm is required!" }}
---
apiVersion: factoryplus.app.amrc.co.uk/v1
kind: KerberosKey
metadata:
  name: sv1manager
  namespace: {{ .Release.Namespace }}
spec:
  type: Random
  principal: sv1manager@{{ .Values.identity.realm | required "values.identity.realm is required!" }}
  secret: manager-keytab/client-keytab
---
apiVersion: factoryplus.app.amrc.co.uk/v1
kind: KerberosKey
metadata:
  name: sv1warehouse
  namespace: {{ .Release.Namespace }}
spec:
  type: Random
  principal: sv1warehouse@{{ .Values.identity.realm | required "values.identity.realm is required!" }}
{{- end -}}